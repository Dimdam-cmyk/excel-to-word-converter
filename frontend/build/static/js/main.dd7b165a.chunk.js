(this["webpackJsonpexcel-to-word-converter-frontend"]=this["webpackJsonpexcel-to-word-converter-frontend"]||[]).push([[0],{98:function(e,t,n){"use strict";n.r(t);var o=n(0),c=n.n(o),a=n(8),r=n.n(a),s=n(134),i=n(135),l=n(139),d=n(137),p=n(130),u=n(136),j=n(141),b=n(127),h=n(138),O=n(12);const m=Object(b.a)((e=>({input:{display:"none"}})));var x=function(e){let{onFileChange:t}=e;const n=m();return Object(O.jsxs)("div",{children:[Object(O.jsx)("input",{accept:".xlsx,.xls",className:n.input,id:"contained-button-file",type:"file",onChange:e=>{const n=e.target.files[0];t(n)}}),Object(O.jsx)("label",{htmlFor:"contained-button-file",children:Object(O.jsx)(p.a,{variant:"contained",color:"default",component:"span",children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c Excel \u0444\u0430\u0439\u043b"})})]})},v=n(61),f=n.n(v);const g=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"http://176.124.219.69:5001/api",w=Object(b.a)((e=>({container:{marginTop:e.spacing(4),display:"flex",flexDirection:"column",alignItems:"center"},button:{marginTop:e.spacing(2)},checkbox:{marginTop:e.spacing(2)},discountInput:{marginTop:e.spacing(2),width:"100%"}})));function y(e){return Object(O.jsx)(h.a,{elevation:6,variant:"filled",...e})}var C=function(){const e=w(),[t,n]=Object(o.useState)(null),[c,a]=Object(o.useState)(!1),[r,b]=Object(o.useState)(null),[h,m]=Object(o.useState)(!1),[v,C]=Object(o.useState)(""),S=(e,t)=>{"clickaway"!==t&&b(null)};return Object(O.jsxs)(s.a,{className:e.container,children:[Object(O.jsx)(i.a,{variant:"h4",gutterBottom:!0,children:"\u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0435\u0440 Excel \u0432 Word"}),Object(O.jsx)(x,{onFileChange:e=>{console.log("\u0424\u0430\u0439\u043b \u0432\u044b\u0431\u0440\u0430\u043d:",e.name),n(e)}}),Object(O.jsxs)("div",{className:e.checkbox,children:[Object(O.jsx)(l.a,{checked:h,onChange:e=>m(e.target.checked),color:"primary"}),Object(O.jsx)(i.a,{component:"span",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043a\u0438\u0434\u043a\u0443"})]}),h&&Object(O.jsx)(d.a,{className:e.discountInput,label:"\u041f\u0440\u043e\u0446\u0435\u043d\u0442 \u0441\u043a\u0438\u0434\u043a\u0438",type:"number",value:v,onChange:e=>C(e.target.value),variant:"outlined",size:"small"}),Object(O.jsx)(p.a,{variant:"contained",color:"primary",onClick:async()=>{if(t){a(!0),b(null);try{console.log("\u041d\u0430\u0447\u0430\u043b\u043e \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438 \u0444\u0430\u0439\u043b\u0430:",t.name);const e=await(async(e,t)=>{const n=new FormData;n.append("file",e),null!==t&&n.append("discountPercentage",t);try{return await f.a.post(`${g}/convert`,n,{headers:{"Content-Type":"multipart/form-data"},responseType:"arraybuffer",withCredentials:!0})}catch(r){if(r.response){const t=(new TextDecoder).decode(r.response.data);throw new Error(t)}throw r}})(t,h?v:null);console.log("\u041e\u0442\u0432\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0435\u043d:",e);const n=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),o=window.URL.createObjectURL(n),c=document.createElement("a");c.href=o,c.download="converted.docx",c.click(),window.URL.revokeObjectURL(o),console.log("\u0424\u0430\u0439\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u0438 \u0441\u043a\u0430\u0447\u0430\u043d")}catch(r){var e;console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438:",r),b((null===(e=r.response)||void 0===e?void 0:e.data)||"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438 \u0444\u0430\u0439\u043b\u0430")}finally{a(!1)}}else b("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043b Excel")},disabled:!t||c,className:e.button,children:c?Object(O.jsx)(u.a,{size:24}):"\u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(O.jsx)(j.a,{open:!!r,autoHideDuration:6e3,onClose:S,children:Object(O.jsx)(y,{onClose:S,severity:"error",children:r})})]})};r.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(C,{})}),document.getElementById("root"))}},[[98,1,2]]]);
//# sourceMappingURL=main.dd7b165a.chunk.js.map