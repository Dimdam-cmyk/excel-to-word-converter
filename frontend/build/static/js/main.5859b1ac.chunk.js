(this["webpackJsonpexcel-to-word-converter-frontend"]=this["webpackJsonpexcel-to-word-converter-frontend"]||[]).push([[0],{98:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n.n(c),a=n(8),r=n.n(a),s=n(134),i=n(135),l=n(139),d=n(137),p=n(130),j=n(136),u=n(141),b=n(127),h=n(138),m=n(10);const O=Object(b.a)((e=>({input:{display:"none"}})));var x=function(e){let{onFileChange:t}=e;const n=O();return Object(m.jsxs)("div",{children:[Object(m.jsx)("input",{accept:".xlsx,.xls",className:n.input,id:"contained-button-file",type:"file",onChange:e=>{const n=e.target.files[0];t(n)}}),Object(m.jsx)("label",{htmlFor:"contained-button-file",children:Object(m.jsx)(p.a,{variant:"contained",color:"default",component:"span",children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c Excel \u0444\u0430\u0439\u043b"})})]})},g=n(61),v=n.n(g);const f=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"http://176.124.219.69:5001/api",w=Object(b.a)((e=>({container:{marginTop:e.spacing(4),display:"flex",flexDirection:"column",alignItems:"center"},button:{marginTop:e.spacing(2)},checkbox:{marginTop:e.spacing(2)},discountInput:{marginTop:e.spacing(2),width:"100%"}})));function y(e){return Object(m.jsx)(h.a,{elevation:6,variant:"filled",...e})}var S=function(){const e=w(),[t,n]=Object(c.useState)(null),[o,a]=Object(c.useState)(!1),[r,b]=Object(c.useState)(null),[h,O]=Object(c.useState)(!1),[g,S]=Object(c.useState)(""),[C,T]=Object(c.useState)(!1),k=(e,t)=>{"clickaway"!==t&&b(null)};return Object(m.jsxs)(s.a,{className:e.container,children:[Object(m.jsx)(i.a,{variant:"h4",gutterBottom:!0,children:"\u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0435\u0440 Excel \u0432 Word"}),Object(m.jsx)(x,{onFileChange:e=>{console.log("\u0424\u0430\u0439\u043b \u0432\u044b\u0431\u0440\u0430\u043d:",e.name),n(e)}}),Object(m.jsxs)("div",{className:e.checkbox,children:[Object(m.jsx)(l.a,{checked:h,onChange:e=>O(e.target.checked),color:"primary"}),Object(m.jsx)(i.a,{component:"span",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043a\u0438\u0434\u043a\u0443"})]}),h&&Object(m.jsx)(d.a,{className:e.discountInput,label:"\u041f\u0440\u043e\u0446\u0435\u043d\u0442 \u0441\u043a\u0438\u0434\u043a\u0438",type:"number",value:g,onChange:e=>S(e.target.value),variant:"outlined",size:"small"}),Object(m.jsxs)("div",{className:e.checkbox,children:[Object(m.jsx)(l.a,{checked:C,onChange:e=>T(e.target.checked),color:"primary"}),Object(m.jsx)(i.a,{component:"span",children:"\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0441\u043e\u043a\u0440\u0430\u0449. \u041a\u041f"})]}),Object(m.jsx)(p.a,{variant:"contained",color:"primary",onClick:async()=>{if(t){a(!0),b(null);try{console.log("\u041d\u0430\u0447\u0430\u043b\u043e \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438 \u0444\u0430\u0439\u043b\u0430:",t.name);const e=await(async(e,t,n)=>{const c=new FormData;c.append("file",e),c.append("originalFileName",e.name),null!==t&&c.append("discountPercentage",t),c.append("makeShortVersion",n);try{return await v.a.post(`${f}/convert`,c,{headers:{"Content-Type":"multipart/form-data"},responseType:"arraybuffer",withCredentials:!0})}catch(r){if(r.response){const t=(new TextDecoder).decode(r.response.data);throw new Error(t)}throw r}})(t,h?g:null,C);console.log("\u041e\u0442\u0432\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0435\u043d:",e);const n=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),c=window.URL.createObjectURL(n),o=document.createElement("a");o.href=c,o.download="converted.docx",o.click(),window.URL.revokeObjectURL(c),console.log("\u0424\u0430\u0439\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u0438 \u0441\u043a\u0430\u0447\u0430\u043d")}catch(r){var e;console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438:",r),b((null===(e=r.response)||void 0===e?void 0:e.data)||"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438 \u0444\u0430\u0439\u043b\u0430")}finally{a(!1)}}else b("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043b Excel")},disabled:!t||o,className:e.button,children:o?Object(m.jsx)(j.a,{size:24}):"\u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(m.jsx)(u.a,{open:!!r,autoHideDuration:6e3,onClose:k,children:Object(m.jsx)(y,{onClose:k,severity:"error",children:r})})]})};r.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)(S,{})}),document.getElementById("root"))}},[[98,1,2]]]);
//# sourceMappingURL=main.5859b1ac.chunk.js.map