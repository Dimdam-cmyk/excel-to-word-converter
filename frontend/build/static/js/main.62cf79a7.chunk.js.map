{"version":3,"sources":["components/FileUploader.js","services/api.js","App.js","index.js"],"names":["useStyles","makeStyles","theme","input","display","FileUploader","_ref","onFileChange","classes","_jsxs","children","_jsx","accept","className","id","type","onChange","event","file","target","files","htmlFor","Button","variant","color","component","container","marginTop","spacing","flexDirection","alignItems","button","Alert","props","MuiAlert","elevation","App","setFile","useState","loading","setLoading","error","setError","handleCloseError","reason","Container","Typography","gutterBottom","selectedFile","console","log","name","onClick","async","response","formData","FormData","append","axios","post","headers","responseType","withCredentials","errorMessage","TextDecoder","decode","data","Error","convertExcelToWord","blob","Blob","url","window","URL","createObjectURL","a","document","createElement","href","download","click","revokeObjectURL","_error$response","disabled","CircularProgress","size","Snackbar","open","autoHideDuration","onClose","severity","ReactDOM","render","React","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.62cf79a7.chunk.js","sourcesContent":["import React from 'react';\nimport { Button } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  input: {\n    display: 'none',\n  },\n}));\n\nfunction FileUploader({ onFileChange }) {\n  const classes = useStyles();\n\n  const handleFileChange = (event) => {\n    const file = event.target.files[0];\n    onFileChange(file);\n  };\n\n  return (\n    <div>\n      <input\n        accept=\".xlsx,.xls\"\n        className={classes.input}\n        id=\"contained-button-file\"\n        type=\"file\"\n        onChange={handleFileChange}\n      />\n      <label htmlFor=\"contained-button-file\">\n        <Button variant=\"contained\" color=\"default\" component=\"span\">\n          Выбрать Excel файл\n        </Button>\n      </label>\n    </div>\n  );\n}\n\nexport default FileUploader;\n","import axios from 'axios';\n\nconst API_URL = 'http://176.124.219.69:5001/api';\n\nexport const convertExcelToWord = async (file) => {\n  const formData = new FormData();\n  formData.append('file', file);\n\n  try {\n    const response = await axios.post(`${API_URL}/convert`, formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n      responseType: 'arraybuffer',\n      withCredentials: true\n    });\n    return response;\n  } catch (error) {\n    if (error.response) {\n      const errorMessage = new TextDecoder().decode(error.response.data);\n      throw new Error(errorMessage);\n    }\n    throw error;\n  }\n};\n","import React, { useState } from 'react';\nimport { Container, Typography, Button, CircularProgress, Snackbar } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport MuiAlert from '@material-ui/lab/Alert';\nimport FileUploader from './components/FileUploader';\nimport { convertExcelToWord } from './services/api';\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    marginTop: theme.spacing(4),\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n  },\n  button: {\n    marginTop: theme.spacing(2),\n  },\n}));\n\nfunction Alert(props) {\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\n}\n\nfunction App() {\n  const classes = useStyles();\n  const [file, setFile] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const handleFileChange = (selectedFile) => {\n    console.log('Файл выбран:', selectedFile.name);\n    setFile(selectedFile);\n  };\n\n  const handleConvert = async () => {\n    if (!file) {\n      setError('Пожалуйста, выберите файл Excel');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      console.log('Начало конвертации файла:', file.name);\n      const response = await convertExcelToWord(file);\n      console.log('Ответ получен:', response);\n\n      const blob = new Blob([response.data], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = 'converted.docx';\n      a.click();\n      window.URL.revokeObjectURL(url);\n      console.log('Файл успешно сконвертирован и скачан');\n    } catch (error) {\n      console.error('Ошибка при конвертации:', error);\n      setError(error.response?.data || 'Произошла ошибка при конвертации файла');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCloseError = (event, reason) => {\n    if (reason === 'clickaway') {\n      return;\n    }\n    setError(null);\n  };\n\n  return (\n    <Container className={classes.container}>\n      <Typography variant=\"h4\" gutterBottom>\n        Конвертер Excel в Word\n      </Typography>\n      <FileUploader onFileChange={handleFileChange} />\n      <Button\n        variant=\"contained\"\n        color=\"primary\"\n        onClick={handleConvert}\n        disabled={!file || loading}\n        className={classes.button}\n      >\n        {loading ? <CircularProgress size={24} /> : 'Конвертировать'}\n      </Button>\n      <Snackbar open={!!error} autoHideDuration={6000} onClose={handleCloseError}>\n        <Alert onClose={handleCloseError} severity=\"error\">\n          {error}\n        </Alert>\n      </Snackbar>\n    </Container>\n  );\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}