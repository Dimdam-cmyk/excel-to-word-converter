{"version":3,"sources":["components/FileUploader.js","services/api.js","App.js","index.js"],"names":["useStyles","makeStyles","theme","input","display","FileUploader","_ref","onFileChange","classes","_jsxs","children","_jsx","accept","className","id","type","onChange","event","file","target","files","htmlFor","Button","variant","color","component","API_URL","process","REACT_APP_API_URL","container","marginTop","spacing","flexDirection","alignItems","button","checkbox","discountInput","width","Alert","props","MuiAlert","elevation","App","setFile","useState","loading","setLoading","error","setError","applyDiscount","setApplyDiscount","discountPercentage","setDiscountPercentage","handleCloseError","reason","Container","Typography","gutterBottom","selectedFile","console","log","name","Checkbox","checked","e","TextField","label","value","size","onClick","async","response","formData","FormData","append","axios","post","headers","responseType","withCredentials","errorMessage","TextDecoder","decode","data","Error","convertExcelToWord","blob","Blob","url","window","URL","createObjectURL","a","document","createElement","href","download","click","revokeObjectURL","_error$response","disabled","CircularProgress","Snackbar","open","autoHideDuration","onClose","severity","ReactDOM","render","React","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.dd7b165a.chunk.js","sourcesContent":["import React from 'react';\nimport { Button } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) => ({\n  input: {\n    display: 'none',\n  },\n}));\n\nfunction FileUploader({ onFileChange }) {\n  const classes = useStyles();\n\n  const handleFileChange = (event) => {\n    const file = event.target.files[0];\n    onFileChange(file);\n  };\n\n  return (\n    <div>\n      <input\n        accept=\".xlsx,.xls\"\n        className={classes.input}\n        id=\"contained-button-file\"\n        type=\"file\"\n        onChange={handleFileChange}\n      />\n      <label htmlFor=\"contained-button-file\">\n        <Button variant=\"contained\" color=\"default\" component=\"span\">\n          Выбрать Excel файл\n        </Button>\n      </label>\n    </div>\n  );\n}\n\nexport default FileUploader;\n","import axios from 'axios';\n\nconst API_URL = process.env.REACT_APP_API_URL || 'http://176.124.219.69:5001/api';\n\nexport const convertExcelToWord = async (file, discountPercentage) => {\n  const formData = new FormData();\n  formData.append('file', file);\n  if (discountPercentage !== null) {\n    formData.append('discountPercentage', discountPercentage);\n  }\n\n  try {\n    const response = await axios.post(`${API_URL}/convert`, formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n      responseType: 'arraybuffer',\n      withCredentials: true\n    });\n    return response;\n  } catch (error) {\n    if (error.response) {\n      const errorMessage = new TextDecoder().decode(error.response.data);\n      throw new Error(errorMessage);\n    }\n    throw error;\n  }\n};\n","import React, { useState } from 'react';\nimport { Container, Typography, Button, CircularProgress, Snackbar, Checkbox, TextField } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport MuiAlert from '@material-ui/lab/Alert';\nimport FileUploader from './components/FileUploader';\nimport { convertExcelToWord } from './services/api';\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    marginTop: theme.spacing(4),\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n  },\n  button: {\n    marginTop: theme.spacing(2),\n  },\n  checkbox: {\n    marginTop: theme.spacing(2),\n  },\n  discountInput: {\n    marginTop: theme.spacing(2),\n    width: '100%',\n  },\n}));\n\nfunction Alert(props) {\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\n}\n\nfunction App() {\n  const classes = useStyles();\n  const [file, setFile] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [applyDiscount, setApplyDiscount] = useState(false);\n  const [discountPercentage, setDiscountPercentage] = useState('');\n\n  const handleFileChange = (selectedFile) => {\n    console.log('Файл выбран:', selectedFile.name);\n    setFile(selectedFile);\n  };\n\n  const handleConvert = async () => {\n    if (!file) {\n      setError('Пожалуйста, выберите файл Excel');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      console.log('Начало конвертации файла:', file.name);\n      const response = await convertExcelToWord(file, applyDiscount ? discountPercentage : null);\n      console.log('Ответ получен:', response);\n\n      const blob = new Blob([response.data], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = 'converted.docx';\n      a.click();\n      window.URL.revokeObjectURL(url);\n      console.log('Файл успешно сконвертирован и скачан');\n    } catch (error) {\n      console.error('Ошибка при конвертации:', error);\n      setError(error.response?.data || 'Произошла ошибка при конвертации файла');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCloseError = (event, reason) => {\n    if (reason === 'clickaway') {\n      return;\n    }\n    setError(null);\n  };\n\n  return (\n    <Container className={classes.container}>\n      <Typography variant=\"h4\" gutterBottom>\n        Конвертер Excel в Word\n      </Typography>\n      <FileUploader onFileChange={handleFileChange} />\n      <div className={classes.checkbox}>\n        <Checkbox\n          checked={applyDiscount}\n          onChange={(e) => setApplyDiscount(e.target.checked)}\n          color=\"primary\"\n        />\n        <Typography component=\"span\">Добавить скидку</Typography>\n      </div>\n      {applyDiscount && (\n        <TextField\n          className={classes.discountInput}\n          label=\"Процент скидки\"\n          type=\"number\"\n          value={discountPercentage}\n          onChange={(e) => setDiscountPercentage(e.target.value)}\n          variant=\"outlined\"\n          size=\"small\"\n        />\n      )}\n      <Button\n        variant=\"contained\"\n        color=\"primary\"\n        onClick={handleConvert}\n        disabled={!file || loading}\n        className={classes.button}\n      >\n        {loading ? <CircularProgress size={24} /> : 'Конвертировать'}\n      </Button>\n      <Snackbar open={!!error} autoHideDuration={6000} onClose={handleCloseError}>\n        <Alert onClose={handleCloseError} severity=\"error\">\n          {error}\n        </Alert>\n      </Snackbar>\n    </Container>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}