(this["webpackJsonpexcel-to-word-converter-frontend"]=this["webpackJsonpexcel-to-word-converter-frontend"]||[]).push([[0],{79:function(e,t,n){"use strict";n.r(t);var o=n(0),c=n.n(o),a=n(12),r=n.n(a),l=n(102),s=n(103),i=n(100),d=n(104),p=n(105),u=n(98),j=n(106),b=n(9);const x=Object(u.a)((e=>({input:{display:"none"}})));var f=function(e){let{onFileChange:t}=e;const n=x();return Object(b.jsxs)("div",{children:[Object(b.jsx)("input",{accept:".xlsx,.xls",className:n.input,id:"contained-button-file",type:"file",onChange:e=>{const n=e.target.files[0];t(n)}}),Object(b.jsx)("label",{htmlFor:"contained-button-file",children:Object(b.jsx)(i.a,{variant:"contained",color:"default",component:"span",children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c Excel \u0444\u0430\u0439\u043b"})})]})},h=n(46),m=n.n(h);const O=Object(u.a)((e=>({container:{marginTop:e.spacing(4),display:"flex",flexDirection:"column",alignItems:"center"},button:{marginTop:e.spacing(2)}})));function w(e){return Object(b.jsx)(j.a,{elevation:6,variant:"filled",...e})}var v=function(){const e=O(),[t,n]=Object(o.useState)(null),[c,a]=Object(o.useState)(!1),[r,u]=Object(o.useState)(null),j=(e,t)=>{"clickaway"!==t&&u(null)};return Object(b.jsxs)(l.a,{className:e.container,children:[Object(b.jsx)(s.a,{variant:"h4",gutterBottom:!0,children:"\u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0435\u0440 Excel \u0432 Word"}),Object(b.jsx)(f,{onFileChange:e=>{console.log("\u0424\u0430\u0439\u043b \u0432\u044b\u0431\u0440\u0430\u043d:",e.name),n(e)}}),Object(b.jsx)(i.a,{variant:"contained",color:"primary",onClick:async()=>{if(t){a(!0),u(null);try{console.log("\u041d\u0430\u0447\u0430\u043b\u043e \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438 \u0444\u0430\u0439\u043b\u0430:",t.name);const e=await(async e=>{const t=new FormData;t.append("file",e);try{return await m.a.post("http://176.124.219.69:5001/api/convert",t,{headers:{"Content-Type":"multipart/form-data"},responseType:"arraybuffer",withCredentials:!0})}catch(r){if(r.response){const t=(new TextDecoder).decode(r.response.data);throw new Error(t)}throw r}})(t);console.log("\u041e\u0442\u0432\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0435\u043d:",e);const n=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),o=window.URL.createObjectURL(n),c=document.createElement("a");c.href=o,c.download="converted.docx",c.click(),window.URL.revokeObjectURL(o),console.log("\u0424\u0430\u0439\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u043d \u0438 \u0441\u043a\u0430\u0447\u0430\u043d")}catch(r){var e;console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438:",r),u((null===(e=r.response)||void 0===e?void 0:e.data)||"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0430\u0446\u0438\u0438 \u0444\u0430\u0439\u043b\u0430")}finally{a(!1)}}else u("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u0439\u043b Excel")},disabled:!t||c,className:e.button,children:c?Object(b.jsx)(d.a,{size:24}):"\u041a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(b.jsx)(p.a,{open:!!r,autoHideDuration:6e3,onClose:j,children:Object(b.jsx)(w,{onClose:j,severity:"error",children:r})})]})};r.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(v,{})}),document.getElementById("root"))}},[[79,1,2]]]);
//# sourceMappingURL=main.62cf79a7.chunk.js.map